
<div class="cmuForumThreadlist cmuThreadlist">

  <div class="cmuThreadlist__ctrl row">

    <div class="cmuThreadlist__ctrl__row col--md12 noPadding">
      <div class="col--md6 noPaddingLeft" community-permissions>
        <button class="button--solid" ng-click="vm.startNewTopic()">${{ forums.list.createTopic }}$</button>
      </div>

      <div class="col--md6 noPaddingRight">
        <community-pager 
          number-of-pages="vm.numberOfPages" 
          pager-fn="vm.forumListFilter"
          front-biased="true">
        </community-pager>
      </div>
    </div>

    <div class="cmuThreadlist__ctrl__row col--md12 noPadding">

      <div class="col--md8 noPaddingLeft">
        <community-show-count 
          lower="vm.messageList.length" 
          upper="vm.messageCount" 
          type="${{ forums.list.threads }}$">
        </community-show-count>
      </div>

      <div class="col--md2">
        <div ng-hide="vm.hideSearch()">
            <community-search 
              search-filter="vm.forumListFilter" 
              placeholder="${{ forums.list.filterTopics }}$"
              exclude="page">
           </community-search>
        </div>
      </div>

      <div class="col--md2 noPaddingRight">
        <community-sort sort-options="vm.messageSortOptions" sort-filter="vm.forumListFilter" sort-exclude="page"></community-sort>
      </div>
    </div>
  </div>


  <div class="row" ng-if="vm.messageList.length < 1">
    <h2 class="cmuHalfRow"> ${{ forums.list.emptyList }}$ </h2>
  </div>

  <div class="row" ng-if="vm.messageList.length > 0">
    <div class="cmuThreadlist__table"> 
      <div class="cmuThreadlist__headers">
        <div class="cmuThreadlist__topic">${{ forums.list.topic }}$</div>
        <div class="cmuThreadlist__preview">
        </div>
        <div class="cmuThreadlist__authorDate">${{ forums.list.created }}$</div>
        <div class="cmuThreadlist__counter cmuThreadlist__views"></div>
        <div class="cmuThreadlist__counter cmuThreadlist__replies"></div>
        <div class="cmuThreadlist__counter cmuThreadlist__kudos"></div>
        <div class="cmuThreadlist__authorDate">${{ core.time.latest }}$</div>
      </div>

      <div class="cmuThreadlist__body">
        <a class="cmuThreadlist__row" 
            area-link-handler="{{ vm.getMessageUrl(message.id) }}"
            ng-repeat="message in vm.messageList"
            ng-class="{'isRead':vm.isRead(message)}"
            >

          <div class="cmuThreadlist__topic">
            {{ ::message.topic.subject | htmlUnescape }}
          </div>

          <div class="cmuThreadlist__preview">
            <span 
              class="cmuThreadlist__tooltip"
              community-tooltip
              data-id-field="{{ ::message.id }}" 
              ajax-populate="vm.getMessageData" 
              tooltip-template="forums/list/forums.list.messagetooltip.html"
              local-data="{ messageUrl: vm.getMessageUrl(message.id) }"
              empty-text="${{ forums.list.emptyPreview }}$"
              tooltip-class="cmuTooltipster"
              position="top-right"
            ><span class="icon ubnt-icon--eye2"></span>
            </span>
          </div>

          <div class="cmuThreadlist__created cmuThreadlist__authorDate">
            <div class="cmuThreadlist__avatar"> 
              <community-user-badge class="cmuUserbadge--showFlag cmuUserbadge--avatarOnly" user="message.topic.message.insertUser"></community-user-badge>
            </div>
            
            <div class="cmuThreadlist__date">{{ ::message.topic.message.postDate | timeFromNow }}
            </div>
          </div>

          <div class="cmuThreadlist__counter cmuThreadlist__views">
            {{  message.topic.countViews | number}}
          </div>
          <div class="cmuThreadlist__counter cmuThreadlist__replies">
            {{  message.context.totalMessageCount - 1 | number}}
          </div>
          <div class="cmuThreadlist__counter cmuThreadlist__kudos">
            {{  message.topic.message.scores.kudo | number}}
          </div>
          <div class="cmuThreadlist__latest cmuThreadlist__authorDate">
            <div class="cmuThreadlist__avatar"> 
              <community-user-badge class="cmuUserbadge--showFlag cmuUserbadge--avatarOnly" user="message.context.lastestMessage.insertUser"></community-user-badge>
            </div>
            <div class="cmuThreadlist__date">{{ message.topic.lastActivityDate | timeFromNow }}
            </div>
          </div>
        </a>
      </div>
      <!-- end body -->

    </div>
  </div>


  <div class="cmuThreadlist__ctrl cmuThreadlist__ctrl--bottom row">
    <div class="cmuThreadlist__ctrl__row col--md12 noPadding">
        <div class="col--md8 noPaddingLeft">
          <button class="button--solid" ng-click="vm.startNewTopic()" community-permissions>${{ forums.list.createTopic }}$</button>
        </div>
        <div class="col--md4 noPaddingLeft">
          <community-pager 
            number-of-pages="vm.numberOfPages" 
            pager-fn="vm.forumListFilter"
            front-biased="true">
          </community-pager>
        </div>
    </div>
  </div>
</div>
