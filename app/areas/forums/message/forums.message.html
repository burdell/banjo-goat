

<div class="cmuThread__subject
	        cmuThread__subject--locked
	        cmuThread__subject--active">
	<div class="row">
		<h3>{{ ::vm.originalMessageSubject | htmlUnescape }}</h3>
	</div>
</div>

<div class="cmuThread__controls">
	<div class="row">
        <div class="col--md8 noPaddingLeft">
        	<span community-permissions>
	        	<button class="button--solid button--padded button-blue-white" ng-click="vm.showTopicReply()">Reply</button>
				<button class="button--outline button-gray-on-white">Options <span class="button--icon icon ubnt-icon--pointer-down"></button>
	        	<button class="button--ghost button--padded button-blue-white">Subscribe</button>
			</span>
		</div>

		<div class="col--md4 noPaddingRight">
			<community-pager 
			  number-of-pages="vm.numberOfPages"
			  pager-fn="vm.messageThreadFilter">
			</community-pager>
		</div>
    </div>
</div>


<div class="cmuThread__container row">
	<div class="col--md12 noPadding" ng-repeat="message in vm.messageThread" handle-image-error>
		<community-message 
			class="cmuMessage 
				   cmuMessage--sidebyside"
			message="message"
			original-message="vm.originalMessage"
			reply-click-fn="vm.showReply"
			show-op="vm.originalMessage.message.insertUser.id"
			thread-filter="vm.messageThreadFilter"
			local-index="$index">
		</community-message>

		<!-- reply -->
		<div class="cmuThread__reply container noPadding" ng-if="vm.messageIsBeingRepliedTo(message.id)">
				<div class="col--md12 noPadding">
					<div class="cmuThread__reply__to">Reply to <span>{{ ::message.insertUser.login }}</span></div>
					<community-comment-form
						reply-button-text="Post Reply" 
						replying-button-text="Posting Reply..." 
						parent-message="message"
						toggle-attribute="vm.currentReply"
						on-success-fn="vm.replyPosted">
					</community-comment-form>
				</div>
			</div>
		</div>
</div>



<div class="cmuThread__controls
			cmuThread__controls--bottom">
	<div class="row">
        <div class="col--md8 noPaddingLeft">
        	<span community-permissions>
	        	<button class="button--solid button-blue-white" ng-click="vm.showTopicReply()">Post Reply</button>
				<button class="button--outline button-gray-on-white">Options <span class="button--icon icon ubnt-icon--pointer-down"></button>
			</span>
		</div>
		<div class="col--md4 noPaddingRight">
			<community-pager 
			  number-of-pages="vm.numberOfPages" 
			  pager-fn="vm.messageThreadFilter">
			</community-pager>
		</div>
	</div>
	<div class="row" ng-if="vm.topicReplyShown">
		<div id="topicReply">
			<community-comment-form
				reply-button-text="Post Reply" 
				replying-button-text="Posting Reply..." 
				parent-message="vm.topicReplyMessage"
				toggle-attribute="vm.topicReplyShown"
				on-success-fn="vm.replyPosted">
			</community-comment-form>
		</div>
	</div>
</div>

<div class="cmuViewingCounter">
	<div class="row">
		<div class="cmuViewingCounter__count">
			5 {{ vm.originalMessage.stats | extractKey : 'currentlyViewing' }} users viewing this thread
		</div>
	</div>
</div>
