
<!-- TESTING STYLE -->
 <style type="text/css" scoped>
    div.forumThreadMessage__linked
    {
      background-color: magenta;
    }
  </style>
<!-- TESTING STYLE -->

<div class="forumThreadSubject">
	<div class="row">
		<h4>{{ ::vm.originalMessage.subject | htmlUnescape }}</h4>
	</div>
</div>

<div class="forumThreadControl">
	<div class="row">
        <div class="col--md6 noPaddingLeft">
	        <button class="button--solid button-blue-white">Create a Topic</button>

			<button class="button--ghost button-blue-white">Follow Topic</button>
		</div>

		<div class="col--md6 noPaddingRight">
			<community-pager 
			  total-results="vm.allMessageCount" 
			  pager-fn="vm.messageThreadFilter">
			</community-pager>
		</div>
    </div>
</div>



<div class="forumThreadMessageContainer" ng-repeat="message in vm.messageThread">
	<div class="row" id="{{ message.id }}">
		<div class="forumThreadMessage clearfix">
		<!-- message -->

			<div class="col--md2 noPadding">
				<community-user-badge user="message.author"></community-user-badge>
			</div>

			<div class="forumThreadMain col--md10" ng-class="{  forumThreadMessage__linked : vm.linkedMessageId == message.id }">
				<div class="forumThreadMain__posted">
					<h6>Posted {{ message.postTime | timeFromNow }}</h6>
				</div>
				<div class="forumThreadMain__body" ng-bind-html="message.body | sanitize">
				</div>
				<div class="forumThreadMain__controls"> 
					<div class="forumThreadMain__controls__main col--md8 noPadding">
						<button class="button-compound button-white-green">
							<span>{{ message.stats | extractKey : 'kudos' }} Kudos</span>
							<span class="icon-plus">+</span>
						</button>
						<button class="button-compound button-white-green">
							<span>123 Votes</span>
							<span>Vote As Helpful</span>
						</button>
					</div>
					<div class="forumThreadMain__controls__reply col--md4 noPadding">
						<button 
							class="button-full button-blue-white" 
							ng-click="vm.showReply(message.id)"
							ng-disabled="vm.messageIsBeingRepliedTo(message.id)">
								Reply
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>

		<!-- reply -->
		<div class="row row--comfy" ng-show="vm.messageIsBeingRepliedTo(message.id)">
				<div class="col--md2">
				</div>
				<div class="col--md10">
					<h6>REPLY to <a href="#">{{ ::message.author.login }}</a></h6>
					<div class="row row--comfy">
						<community-text-editor ng-model="vm.messageReplyText"></community-text-editor>
					</div>
					<div>
						<button 
							class="button-ghost button-white-blue" 
							ng-click="vm.cancelReply()">
								Cancel
						</button>
						<button 
							class="button-full button-blue-white"
							ng-click="vm.submitReply(message.id)">
								Submit Comment
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


<div class="forumThreadMain__bottomControls">
	<div class="row">
		<div class="col--md6">
			<button class="button-full button-blue-white">Start a Discussion</button>
		</div>
		<div class="col--md6">
			<community-pager 
			  total-results="vm.allMessageCount" 
			  pager-fn="vm.messageThreadFilter">
			</community-pager>
		</div>
	</div>
</div>


<div class="forumThreadMain__activeCount ">
	<div class="row">
		<div class="activeCounter">
			<span>{{ vm.originalMessage.stats | extractKey : 'currentlyViewing' }}</span><span>other people are viewing this thread</span>
		</div>
	</div>
</div>
