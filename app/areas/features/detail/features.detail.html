<div class="cmuFeatureDetails cmuThread">
	<div class="row">
		<div class="row">
			<div class="cmuFeatures__votes col--md2">
				<div class="cmuFeatures__votes__count">{{ vm.originalMessage.countVotes }}<span class="cmuFeatures__votes__caption">votes</span></div>
				<div class="cmuFeatures__votes__status {{ vm.originalMessage.state | lowercase }} ">
					{{ ::vm.getStatusText(vm.originalMessage) }}
				</div>
			</div>

			<div class="col--md10">
				<div class="cmuThread__subject">
					<div class="row">

						<div class="col--md10">
							<h3>{{ vm.originalMessage.subject }}</h3>
						</div>

						<div class="col--md2 alignRight">
							<community-sort sort-options="vm.messageSortOptions" sort-filter="vm.commentFilter" sort-exclude="limit, offset"></community-sort>
						</div>

					</div>
				</div>

				<div class="cmuThread__stats">
					<div class="row">
						<div class="col--md12">
							<!-- date / time already taken care of in the post! -->
							<!-- <span class="cmuInlineInfo__data cmuThread__date" data-divider=" | "><span>Posted </span>{{ ::feature.discussion.postTime | timeFromNow }}</span> -->

							<div class="cmuThread__stat"><span class="cmuThread__stat__desc">Product:</span><span class="cmuThread__stat__status">airFiber Feature Requests{{ ::vm.description }}</span></div>
							<div class="cmuThread__stat"><span class="cmuThread__stat__desc">Version:</span><span class="cmuThread__stat__status">1.1.1.1{{ ::vm.getMetaValue('versionNumber') }}</span></div>
							<div class="cmuThread__stat"><span class="cmuThread__stat__desc">Issue #</span><span class="cmuThread__stat__status">ABC123{{ ::vm.getMetaValue('issueId') }}</span></div>
						</div>
					</div>
					
				</div>
			</div>
		</div>


		<div class="row cmuThread__controls">
			<span community-permissions>
				<div class="col--md1">
	        		<button class="button--solid button-white-on-green button--stretch">Vote</button>
	        	</div>
				<div class="col--md1">
	        		<button class="button--solid button--stretch" ng-click="vm.showFeatureReply()">Reply</button>
	        	</div>
			</span>
			<div class="col--md4 col--mdOffset6">
				<community-pager 
			  	  number-of-pages="vm.numberOfPages" 
				  pager-fn="vm.commentFilter">
				</community-pager>
			</div>
		</div>



		<div class="cmuThread__firstPost">

		
			<community-user-badge 
				class="cmuUserbadge--thin"
				user="vm.originalMessage.message.context.parentAuthor"
				op-id="messageDisplay.showOp">
			</community-user-badge>


			<div class="cmuMessage__data">
				<div class="cmuMessage__counter"></div>
				<div class="cmuMessage__date">{{ vm.originalMessage.message.postDate | exactTimeFromNow }}</div>
			</div>

			<div class="cmuMessage__content row">
				<div class="col--md12" ng-bind-html="vm.originalMessage.message.body | sanitize"></div>
			</div>
		</div>
	</div>

	<div class="row">
		<div ng-repeat="message in vm.commentList">
			<community-message 
				message="message"
				reply-click-fn="vm.showReply"
				show-op="vm.originalMessage.author.id"
				upvote-only="true"
				thread-filter="vm.commentFilter"
				local-index="$index">
			</community-message>
		
			<div class="cmuThread__reply container noPadding" ng-if="vm.messageIsBeingRepliedTo(message.id)">
					<div class="col--md12 noPadding">
						<div class="cmuThread__reply__to">Reply to <span>{{ ::message.insertUser.login }}</span></div>
						<community-comment-form
							reply-button-text="Post Reply" 
							replying-button-text="Posting Reply..." 
							parent-message="message"
							toggle-attribute="vm.currentReply"
							on-success-fn="vm.replyPosted">
						</community-comment-form>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col--md2 noPadding">
			<span community-permissions>
	        	<button class="button--solid button--stretch button-blue-white" ng-click="vm.showFeatureReply()">Reply</button>
			</span>
		</div>
		<div class="col--md4 col--mdOffset6 noPadding">
			<community-pager 
			  number-of-pages="vm.numberOfPages" 
			  pager-fn="vm.commentFilter">
			</community-pager>
		</div>
	</div>

	<div class="row" ng-if="vm.featureReplyShown">
		<community-comment-form
			reply-button-text="Post Reply" 
			replying-button-text="Posting Reply..." 
			parent-message="vm.originalMessage.message"
			toggle-attribute="vm.featureReplyShown"
			on-success-fn="vm.replyPosted">
		</community-comment-form>
	</div>

</div>
