
<div class="cmuProfile">
 	<community-page-header
 		hide-element-selector=".cmuDiscussionsControls">
 	</community-page-header>

 	<!-- custom header -->
 	<div class="cmuProfile__header">
		<div class="row">
			<community-username class="cmuUsername--header" user="vm.userData"></community-username>
		</div>
		<div class="cmuProfile__rank row">
			<span>{{ vm.userData.rank.name }}</span>
		</div>
	</div>


	<div class="row profile-container">

		<!-- sidebar -->
		<div class="cmuProfile__sidebar col--md3">
			<div class="cmuProfile__section row">



				<div><img ng-src="{{ vm.userData.avatarUrl }}&amp;s=200" /></div>
				<button class="button--solid" >${{ directory.user.editProfile }}$</button>
			</div>

			<div class="cmuProfile__section row">
				<div ng-if="vm.userData.locName">
					<label class="cmuProfile__sidebar__label">${{ directory.user.location }}$</label>
					<p>{{ vm.userData.locName }}</p>
				</div>

				<div class="cmuProfile__subSection" ng-if="vm.userData.meta.personalSiteUrl.value">
					<label class="cmuProfile__sidebar__label">${{ directory.user.personalWebpage }}$</label>
					<p>{{ vm.userData.meta.personalSiteUrl.value }}</p>
				</div>

				<div class="cmuProfile__subSection" ng-if="vm.userData.meta.occupation">
					<label class="cmuProfile__sidebar__label">${{ directory.user.occupation }}$</label>
					<p>{{ vm.userData.meta.occupation.value }}</p>
				</div>

				<div class="cmuProfile__subSection" >
					<label class="cmuProfile__sidebar__label">${{ directory.user.dateRegistered }}$</label>
					<p>{{ vm.userData.registrationDate | date }}</p>
				</div>

				<div class="cmuProfile__subSection" >
					<label class="cmuProfile__sidebar__label">${{ directory.user.dateLastVisited }}$</label>
					<p>{{ vm.userData.lastOnlineDate | date }}</p>
				</div>
			</div>

			<div class="cmuProfile__section row" ng-if="vm.userData.meta.bioText">
				<div class="cmuProfile__subSection" >
					<label class="cmuProfile__sidebar__label">${{ directory.user.aboutMe }}$</label>
					<p>{{ vm.userData.bioText }}</p>
				</div>
			</div>

		</div>

		<!-- main body -->
		<div class="cmuProfile__main col--md9">

			<div class="cmuProfile__points cmuProfile__section row">
				<div class="cmuProfile__points__progress">
					<h1>{{ vm.totalPoints }} ${{ directory.user.totalPoints }}$ ({{ vm.percentageComplete }}%)</h1>
				</div>

				<div class="cmuProfile__points__stats">
					<div class="col--md2" ng-repeat="category in ::vm.scoreCategories">
						<div><h3>{{ category.count }}</h3></div>
						<h6>{{ category.name }}</h6>
					</div>
				</div>
			</div>


			<div class="cmuProfile__section row">
				<div class="cmuProfile__tabs">
					<button class="button--tab button--wide" ng-class="{'active': vm.profileSummaryShown == true}" ng-click="vm.profileSummaryShown = true">${{ directory.user.profileInfo }}$</button><button class="button--tab button--wide" ng-class="{'active': vm.profileSummaryShown == false}" ng-click="vm.profileSummaryShown = false">${{ directory.user.earnPoints }}$</button>
				</div>


				<!-- 
					PROFILE SUMMARY
				-->
				<div class="cmuProfile__summary" ng-show="vm.profileSummaryShown">

					<!-- stories -->
			        <div class="cmuProfile__stories">
			        
			        	<div class="cmuProfile__title clearfix">
							<div ng-pluralize count="vm.totalStories" when="{ '0': '${{ stories.noun.none }}$', 'one': '1 ${{ stories.noun.singular }}$', 'other': '{} ${{ stories.noun.plural }}$' }"></div>
						</div>

						<div class="cmuProfile__section clearfix">
							<div class="col--md12 noPadding" community-grid-list>
								<div class="cmuStoryGrid">
									<div class="cmuProfile__story cmuStoryGrid__item" ng-repeat="story in vm.storyList">
										<story-display 
											story="story"
											story-media="story.media"
											default-photo-url="vm.defaultPhoto">
										</story-display>
									</div>
								</div>
							</div>
							<div class="cmuProfile__subSection">
								<button class="cmuProfile__loadMore button--stretch
								button--large
								button--wide
								button--solid" ng-click="vm.loadMore('stories')" ng-show="vm.hasMoreStories">${{ core.actions.showMore }}$</button>
							</div>
						</div>
					</div>	



				  	<!-- feed -->
				  	<div class="cmuProfile__activity">

			        	<div class="cmuProfile__title clearfix">
							<div>${{ directory.user.recentActivity }}$</div>
						</div>

						<div class="cmuProfile__subSection">
					  		<div ng-repeat="activityItem in vm.activityList">
				        		<community-feed-content content-model="activityItem"></community-feed-content>
				        	</div>
				        </div>

						<div class="cmuProfile__subSection">
			        		<button class="cmuProfile__loadMore button--stretch button--center button--large button--solid" ng-click="vm.loadMore('activity')" ng-show="vm.hasMoreActivity">${{ core.actions.showMore }}$</button>
						</div>
				  	</div>
				</div>



				<!-- 
					POINTS TABLE
				-->

				<div class="col--md12" ng-show="!vm.profileSummaryShown">
			        <div class="cmuProfile__pointsTable cmuProfile__section">
			        	<div class="cmuProfile__title clearfix">
							<h5><span class="cmuIcon__label all"></span>${{ directory.user.recentActivity }}$</h5>
						</div>
						<div class="cmuProfile__table">
							<div ng-repeat="category in ::vm.pointCategories" class="row row--comfy">
								<div class="col--md1"><h2>{{ category.points }}</h2></div>
								<div class="col--md11">
									<h5>{{ category.name }}</h5>
									<p>{{ category.description }}</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>